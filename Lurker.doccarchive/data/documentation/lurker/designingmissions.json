{"seeAlsoSections":[{"title":"Getting Started","identifiers":["doc:\/\/Lurker\/documentation\/Lurker\/UsingLurker","doc:\/\/Lurker\/documentation\/Lurker\/Debugging"],"generated":true}],"schemaVersion":{"major":0,"minor":2,"patch":0},"sections":[],"primaryContentSections":[{"kind":"content","content":[{"anchor":"Overview","level":2,"type":"heading","text":"Overview"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Begin by creating an object that conforms to the "},{"type":"codeVoice","code":"Mission"},{"type":"text","text":" protocol. Return a specific "},{"type":"codeVoice","code":"style"},{"type":"text","text":" and "},{"type":"codeVoice","code":"identifier"},{"type":"text","text":" which matches your declared ID as well as preferred "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Lurker\/documentation\/Lurker\/MissionStyle"},{"type":"text","text":"."}]},{"type":"aside","style":"tip","content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Using a "},{"type":"codeVoice","code":"struct"},{"type":"text","text":" or "},{"type":"codeVoice","code":"final class"},{"type":"text","text":" will help provide automatic conformance to "},{"type":"codeVoice","code":"Mission"},{"type":"text","text":"’s required "},{"type":"codeVoice","code":"Sendable"},{"type":"text","text":" conformance."}]}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Write any code necessary to perform your background task in the "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Lurker\/documentation\/Lurker\/Mission\/runTask(_:)"},{"type":"text","text":" implementation."}]},{"type":"aside","style":"important","content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Always implement the passed-in "},{"type":"codeVoice","code":"BGTask"},{"type":"text","text":"’s "},{"type":"codeVoice","code":"expirationHandler"},{"type":"text","text":" to properly cancel or clean up unfinished tasks and avoid system termination. There is no need, however to call or implement "},{"type":"codeVoice","code":"setTaskCompleted"},{"type":"text","text":". This is handled for you by the return value you provide."}]}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Optionally return a "},{"type":"codeVoice","code":"Date"},{"type":"text","text":" from "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Lurker\/documentation\/Lurker\/Mission\/earliestStart()"},{"type":"text","text":" to indicate a delay prior to the system running this task for the first time."}]},{"anchor":"Example-Mission","level":3,"type":"heading","text":"Example Mission"},{"type":"codeListing","syntax":"swift","code":["import Foundation","import BackgroundTasks","import Lurker","","final class SecretMission: Mission {","","    var identifier: String {","        return \"com.yourApp.backgroundRefresh.secretMission\"","    }","","    var style: MissionStyle {","        return .brief","    }","","    func runTask(_ taskInfo: BGTask) async -> Bool {","        let updateTask = Task { () -> Bool in","            \/\/ Perform some task","            return true","        }","        ","        taskInfo.expirationHandler = {","            updateTask.cancel()","        }","        ","        let success = await updateTask.value","        return success","    }","    ","    func earliestStart() -> Date? {","        return nil","    }","    ","}",""]},{"anchor":"Understanding-Mission-Styles","level":3,"type":"heading","text":"Understanding Mission Styles"},{"type":"paragraph","inlineContent":[{"type":"text","text":"There are important differences in Mission Styles and the way that the system handles each. Continue reading about "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Lurker\/documentation\/Lurker\/MissionStyle"},{"type":"text","text":"."}]},{"anchor":"Debugging","level":3,"type":"heading","text":"Debugging"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Find out how "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Lurker\/documentation\/Lurker\/Debugging"},{"type":"text","text":" works with Background Tasks."}]}]}],"variants":[{"paths":["\/documentation\/lurker\/designingmissions"],"traits":[{"interfaceLanguage":"swift"}]}],"identifier":{"url":"doc:\/\/Lurker\/documentation\/Lurker\/DesigningMissions","interfaceLanguage":"swift"},"abstract":[{"type":"text","text":"A "},{"type":"codeVoice","code":"Mission"},{"type":"text","text":" encapsulates a singular background task or piece of work to perform. The "},{"type":"codeVoice","code":"Mission"},{"type":"text","text":" protocol defines a few parameters that your subclass will need to provide and a function where work can be performed."}],"kind":"article","metadata":{"modules":[{"name":"Lurker"}],"role":"collectionGroup","title":"Designing Missions"},"hierarchy":{"paths":[["doc:\/\/Lurker\/documentation\/Lurker"],["doc:\/\/Lurker\/documentation\/Lurker","doc:\/\/Lurker\/documentation\/Lurker\/UsingLurker"]]},"topicSections":[{"title":"Missions","identifiers":["doc:\/\/Lurker\/documentation\/Lurker\/MissionStyle","doc:\/\/Lurker\/documentation\/Lurker\/Mission"]},{"title":"Properties","identifiers":["doc:\/\/Lurker\/documentation\/Lurker\/Mission\/identifier","doc:\/\/Lurker\/documentation\/Lurker\/Mission\/style"]},{"title":"Functions","identifiers":["doc:\/\/Lurker\/documentation\/Lurker\/Mission\/runTask(_:)","doc:\/\/Lurker\/documentation\/Lurker\/Mission\/earliestStart()"]},{"title":"Debugging","identifiers":["doc:\/\/Lurker\/documentation\/Lurker\/Debugging"]}],"references":{"doc://Lurker/documentation/Lurker/UsingLurker":{"role":"collectionGroup","title":"Using Lurker","abstract":[{"type":"text","text":"Lurker makes it easy to setup, schedule, and manage background tasks in your app. Learn how to get up and running with Lurker once you’ve configured your app for background tasks."}],"identifier":"doc:\/\/Lurker\/documentation\/Lurker\/UsingLurker","kind":"article","type":"topic","url":"\/documentation\/lurker\/usinglurker"},"doc://Lurker/documentation/Lurker/Debugging":{"role":"collectionGroup","title":"Debugging","abstract":[{"type":"text","text":"Unlike the legacy Background Fetch APIs, Background Tasks are not as easy to debug and cannot be tested in the iOS or iPadOS Simulator."}],"identifier":"doc:\/\/Lurker\/documentation\/Lurker\/Debugging","kind":"article","type":"topic","url":"\/documentation\/lurker\/debugging"},"doc://Lurker/documentation/Lurker":{"role":"collection","title":"Lurker","abstract":[{"type":"text","text":"An abstraction over the system’s Background Task API."}],"identifier":"doc:\/\/Lurker\/documentation\/Lurker","kind":"symbol","type":"topic","url":"\/documentation\/lurker"},"doc://Lurker/documentation/Lurker/Mission/identifier":{"role":"symbol","title":"identifier","fragments":[{"kind":"keyword","text":"var"},{"kind":"text","text":" "},{"kind":"identifier","text":"identifier"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"String","preciseIdentifier":"s:SS"}],"abstract":[{"type":"text","text":"The identifier for the background task. The identifier must be included in the"},{"type":"text","text":" "},{"type":"codeVoice","code":"BGTaskSchedulerPermittedIdentifiers"},{"type":"text","text":" value in your app’s Info.plist."}],"identifier":"doc:\/\/Lurker\/documentation\/Lurker\/Mission\/identifier","kind":"symbol","required":true,"type":"topic","url":"\/documentation\/lurker\/mission\/identifier"},"doc://Lurker/documentation/Lurker/Mission/runTask(_:)":{"role":"symbol","title":"runTask(_:)","fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"runTask"},{"kind":"text","text":"("},{"kind":"typeIdentifier","text":"BGTask","preciseIdentifier":"c:objc(cs)BGTask"},{"kind":"text","text":") "},{"kind":"keyword","text":"async"},{"kind":"text","text":" -> "},{"kind":"typeIdentifier","text":"Bool","preciseIdentifier":"s:Sb"}],"abstract":[{"type":"text","text":"Asynchronous function called by a "},{"type":"codeVoice","code":"Lurker"},{"type":"text","text":" that gets registered and then"},{"type":"text","text":" "},{"type":"text","text":"executed later in the background."}],"identifier":"doc:\/\/Lurker\/documentation\/Lurker\/Mission\/runTask(_:)","kind":"symbol","required":true,"type":"topic","url":"\/documentation\/lurker\/mission\/runtask(_:)"},"doc://Lurker/documentation/Lurker/Mission/earliestStart()":{"role":"symbol","title":"earliestStart()","fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"earliestStart"},{"kind":"text","text":"() -> "},{"kind":"typeIdentifier","text":"Date","preciseIdentifier":"s:10Foundation4DateV"},{"kind":"text","text":"?"}],"abstract":[{"type":"text","text":"Specify the earliest allowable time (from now) that the system may schedule this"},{"type":"text","text":" "},{"type":"text","text":"task. Return "},{"type":"codeVoice","code":"nil"},{"type":"text","text":" to indicate that the system may begin the task as soon as it"},{"type":"text","text":" "},{"type":"text","text":"determines is appropriate."}],"identifier":"doc:\/\/Lurker\/documentation\/Lurker\/Mission\/earliestStart()","kind":"symbol","required":true,"type":"topic","url":"\/documentation\/lurker\/mission\/earlieststart()"},"doc://Lurker/documentation/Lurker/MissionStyle":{"role":"symbol","title":"MissionStyle","fragments":[{"kind":"keyword","text":"enum"},{"kind":"text","text":" "},{"kind":"identifier","text":"MissionStyle"}],"abstract":[{"type":"text","text":"The type of background task to schedule; can be either a brief task or an"},{"type":"text","text":" "},{"type":"text","text":"extended one."}],"identifier":"doc:\/\/Lurker\/documentation\/Lurker\/MissionStyle","kind":"symbol","type":"topic","navigatorTitle":[{"kind":"identifier","text":"MissionStyle"}],"url":"\/documentation\/lurker\/missionstyle"},"doc://Lurker/documentation/Lurker/Mission":{"role":"symbol","title":"Mission","fragments":[{"kind":"keyword","text":"protocol"},{"kind":"text","text":" "},{"kind":"identifier","text":"Mission"}],"abstract":[{"type":"text","text":"A specific, isolated task that can be run in the background."}],"identifier":"doc:\/\/Lurker\/documentation\/Lurker\/Mission","kind":"symbol","type":"topic","navigatorTitle":[{"kind":"identifier","text":"Mission"}],"url":"\/documentation\/lurker\/mission"},"doc://Lurker/documentation/Lurker/Mission/style":{"role":"symbol","title":"style","fragments":[{"kind":"keyword","text":"var"},{"kind":"text","text":" "},{"kind":"identifier","text":"style"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"MissionStyle","preciseIdentifier":"s:6Lurker12MissionStyleO"}],"abstract":[{"type":"text","text":"The background task style, "},{"type":"codeVoice","code":"MissionStyle"},{"type":"text","text":". Generally, this indicates the nature"},{"type":"text","text":" "},{"type":"text","text":"of the task and the expected run time."}],"identifier":"doc:\/\/Lurker\/documentation\/Lurker\/Mission\/style","kind":"symbol","required":true,"type":"topic","url":"\/documentation\/lurker\/mission\/style"}}}